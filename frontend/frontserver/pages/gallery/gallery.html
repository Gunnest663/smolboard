<body>
	<div class="gallery">
		{{ template "nav" . }}
	
		<div class="content">
			<aside>
				<div class="gallery-info">
					<legend>Gallery Information</legend>
	
					<div class="gallery-table table">
						<span>Total</span>
						<span id="total">{{ humanizeNumber .Total }}</span>
	
						<span>Size</span>
						<span id="size">{{ humanizeSize .Sizes }}</span>
					</div>
				</div>
	
				{{ if (gt .Total 25) }}
				<form class="paginator" action="/posts">
					<legend>Gallery Page</legend>
	
					<input type="hidden" name="q" value={{ .Query }}>
	
					{{ $lastPage := (numPages .Total) }}
					{{ $prevPage := (dec .Page) }}
					{{ $nextPage := (inc .Page) }}
	
					<div class="page-buttons">
						<button type="submit" class="last-page small" name="p"
							{{ if (gt $prevPage 0) }}
							value="{{ $prevPage }}"
							{{ else }}
							disabled
							{{ end }}
						>
							❮ Prev
						</button>
	
						<input type="submit" style="display: none">
						<input type="number" class="page-input small"
							   alt="Page Number"
							   min="1" max="{{ $lastPage }}" value="{{ .Page }}"
						>
						<span class="max-page"> / {{ $lastPage }}</span>
	
						<button type="submit" class="next-page small" name="p"
							{{ if (le $nextPage $lastPage) }}
							value="{{ $nextPage }}"
							{{ else }}
							disabled
							{{ end }}
						>
							Next ❯
						</button>
					</div>
				</form>
				{{ end }}
	
				{{ with .User }}
				<div class="search-user-info">
					<legend>User Information</legend>
	
					<div class="user-table table">
						<span>Joined</span>
						<time datetime="{{ htmlTime .Joined }}" id="join-time">
							{{ humanizeTime .Joined }}
						</time>
	
						<span>Permission</span>
						<span id="permission">{{ .Permission }}</span>
					</div>
				</div>
				{{ end }}
	
				{{ with .AllowedUploadPerms }}
				<form class="uploader"
					  action="/posts" method="post"
					  enctype="multipart/form-data"
				>
					<legend>Upload Files</legend>
	
					<input  type="file"     name="file" multiple>
					<select id="permission" name="p">
						{{ range . }}
						<option value="{{ .StringInt }}">{{ . }}</option>
						{{ end }}
					</select>
	
					<button class="upload small" type="submit">
						<span>Upload</span>

						{{/* Hidden overlay to prevent clicks */}}
						<div class="uploading-overlay">
							<div role="progressbar" class="spinner primary"></div>
						</div>
					</button>
				</form>
				{{ end }}
	
				{{ if .Username }}
				<form class="logout" action="/signout" method="post">
					<button type="submit" class="small">Sign out</button>
				</form>
				{{ end }}
			</aside>
	
			<main class="posts row">
				{{ range .Posts }}
				<figure class="gallery-post card">
					<a href="/posts/{{.ID}}">
						<img alt="" {{ $.SizeAttr . }}
							 src="{{ $.Session.PostThumbURL . }}"
							 style="background-image: url('{{ $.InlineImage . }}')"
						>
						</object>
					</a>
				</figure>
				{{ end }}
			</main>
		</div>
	</div>
	
	{{ template "footer" }}
</body>
